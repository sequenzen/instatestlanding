<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI PPT ìë™ ìƒì„±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      body {
        font-family: 'Pretendard', sans-serif;
      }
      .hidden-iframe {
        display: none;
        width: 0;
        height: 0;
        border: 0;
        border: none;
      }
    </style>
  </head>
  <body class="bg-white text-gray-900 min-h-screen flex flex-col relative isolate overflow-hidden">
    <div class="absolute inset-0 -z-10 overflow-hidden">
      <div class="absolute left-1/2 top-0 transform -translate-x-1/2 blur-3xl">
        <div class="aspect-[1155/678] w-[80rem] bg-gradient-to-tr from-indigo-300 via-purple-300 to-pink-300 opacity-25" style="clip-path: polygon(74.1% 44.1%, 100% 61.6%, 97.5% 26.9%, 85.5% 0.1%, 80.7% 2%, 72.5% 32.5%, 60.2% 62.4%, 52.4% 68.1%, 47.5% 58.3%, 45.2% 34.5%, 27.5% 76.7%, 0.1% 64.9%, 17.9% 100%, 27.6% 76.8%, 76.1% 97.7%, 74.1% 44.1%)"></div>
      </div>
    </div>

    <main class="flex-grow flex items-center justify-center px-4">
      <section class="w-full max-w-3xl py-24 text-center">
        <h1 class="text-4xl sm:text-5xl font-bold tracking-tight text-gray-900">AIê°€ ëŒ€ì‹  ë§Œë“¤ì–´ì£¼ëŠ” PPT</h1>
        <p class="mt-6 text-lg leading-8 text-gray-600">ì£¼ì œë§Œ ì…ë ¥í•˜ë©´ 10ë¶„ ë§Œì— ë°œí‘œìë£Œ ì™„ì„±! ë””ìì¸ê³¼ êµ¬ì„±ê¹Œì§€ ìë™í™”ëœ AI ë°œí‘œ ìë£Œ ìƒì„±ê¸°.</p>
        <p class="mt-4 text-sm text-indigo-600 font-medium">í˜„ì¬ ëŒ€ê¸°ìê°€ ë§ìŠµë‹ˆë‹¤. ì´ë©”ì¼ì„ ë‚¨ê¸°ì‹œë©´ ìˆœì„œì— ë”°ë¼ ì•ˆë‚´ë“œë¦½ë‹ˆë‹¤.</p>

        <!-- Google Apps Scriptë¡œ ì „ì†¡í•  í¼ -->
        <form id="email-form" class="mt-10 flex flex-col justify-center max-w-md mx-auto gap-4" 
              target="hidden-iframe" 
              action="https://script.google.com/macros/s/AKfycbxC3xSiqeRcuN_efM9SIXyNz2F3PQGn1CCvVFLn_8Lh-KVRIJ8p9lZ4GVivMIHVTnEg/exec" 
              method="POST">
          <div class="flex flex-col sm:flex-row gap-4">
            <input id="email" name="email" type="email" required placeholder="ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”"
              class="min-w-0 flex-auto rounded-md bg-white px-4 py-2 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-indigo-500 sm:text-sm" />
          </div>
          
          <!-- ìˆ¨ê²¨ì§„ ì´ë¦„ í•„ë“œ ì¶”ê°€ (ì„œë²„ ì¸¡ ì²˜ë¦¬ ìœ ì§€) -->
          <input type="hidden" id="name" name="name" value="PPT ë°©ë¬¸ì">
          
          <!-- ìˆ¨ê²¨ì§„ íƒ€ì„ìŠ¤íƒ¬í”„ í•„ë“œ ì¶”ê°€ -->
          <input type="hidden" id="timestamp" name="timestamp" value="">
          
          <button type="submit"
            class="rounded-md bg-indigo-600 px-5 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600">
            í™•ì¸
          </button>
        </form>
        
        <!-- ìˆ¨ê²¨ì§„ iframe -->
        <iframe name="hidden-iframe" id="hidden-iframe" class="hidden-iframe"></iframe>
        
        <div id="submission-success" class="mt-4 text-green-600 hidden">
          ê°ì‚¬í•©ë‹ˆë‹¤! ì´ë©”ì¼ì´ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.
        </div>
        <div id="submission-error" class="mt-4 text-red-600 hidden">
          ì œì¶œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.
        </div>
      </section>
    </main>

    <footer class="text-center text-sm text-gray-500 py-8">
      Â© 2025 benly. All rights reserved.
    </footer>

    <!-- í˜ì´ì§€ ë°©ë¬¸ ë¡œê¹…ì„ ìœ„í•œ ìŠ¤í¬ë¦½íŠ¸ -->
    <script>
      // í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹¤í–‰ë˜ëŠ” ë°©ë¬¸ì ë¡œê·¸ ê¸°ë¡ í•¨ìˆ˜
      window.addEventListener('load', function() {
        // ë°©ë¬¸ì ì •ë³´ ìˆ˜ì§‘
        const visitTime = new Date().toISOString();
        const userAgent = navigator.userAgent;
        const language = navigator.language;
        const referrer = document.referrer || 'direct';
        const screenSize = `${window.screen.width}x${window.screen.height}`;
        
        // ì¤‘ë³µ ë°©ë¬¸ ë°©ì§€ë¥¼ ìœ„í•œ ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€ í™•ì¸
        const lastVisit = sessionStorage.getItem('lastVisit');
        const currentTime = new Date().getTime();
        
        // 30ë¶„(1800000ms) ì´ë‚´ ì¬ë°©ë¬¸ì´ë©´ ê¸°ë¡í•˜ì§€ ì•ŠìŒ
        if (lastVisit && (currentTime - parseInt(lastVisit)) < 1800000) {
          console.log('ğŸ“Š ìµœê·¼ ë°©ë¬¸ ê¸°ë¡ì´ ìˆì–´ ì¤‘ë³µ ê¸°ë¡ì„ ë°©ì§€í•©ë‹ˆë‹¤.');
          return;
        }
        
        // í˜„ì¬ ì‹œê°„ ì €ì¥
        sessionStorage.setItem('lastVisit', currentTime.toString());
        
        console.log('ğŸ” ë°©ë¬¸ ê¸°ë¡ ì „ì†¡ ì¤‘...');
        
        // ë°©ë¬¸ ë°ì´í„° ìƒì„±
        const formData = new FormData();
        formData.append('email', 'ë°©ë¬¸ì(ë¯¸ì…ë ¥)');
        formData.append('name', 'ì‚¬ì´íŠ¸ ë°©ë¬¸ì');
        formData.append('sheet', 'Sheet4'); // ë°©ë¬¸ ê¸°ë¡ìš© ì‹œíŠ¸ (ë³„ë„ ìƒì„± í•„ìš”)
        formData.append('timestamp', visitTime);
        formData.append('userAgent', userAgent);
        formData.append('referrer', referrer);
        formData.append('language', language);
        formData.append('screenSize', screenSize);
        formData.append('isPageVisit', 'true'); // ë°©ë¬¸ ê¸°ë¡ì„ì„ í‘œì‹œ
        
        // ìˆ¨ê²¨ì§„ iframe ìƒì„± ë˜ëŠ” ì¬ì‚¬ìš©
        let visitFrame = document.getElementById('visit-iframe');
        if (!visitFrame) {
          visitFrame = document.createElement('iframe');
          visitFrame.id = 'visit-iframe';
          visitFrame.name = 'visit-iframe';
          visitFrame.style.display = 'none';
          document.body.appendChild(visitFrame);
        }
        
        // í¼ ìƒì„± ë° ì œì¶œ
        const form = document.createElement('form');
        form.method = 'POST';
        form.action = 'https://script.google.com/macros/s/AKfycbxC3xSiqeRcuN_efM9SIXyNz2F3PQGn1CCvVFLn_8Lh-KVRIJ8p9lZ4GVivMIHVTnEg/exec';
        form.target = 'visit-iframe';
        
        // í¼ ë°ì´í„° ì¶”ê°€
        for (const pair of formData.entries()) {
          const input = document.createElement('input');
          input.type = 'hidden';
          input.name = pair[0];
          input.value = pair[1];
          form.appendChild(input);
        }
        
        // ë¬¸ì„œì— í¼ ì¶”ê°€í•˜ê³  ìë™ ì œì¶œ
        document.body.appendChild(form);
        form.submit();
        
        // í¼ ì œê±°
        setTimeout(() => {
          document.body.removeChild(form);
          console.log('âœ… ë°©ë¬¸ ê¸°ë¡ì´ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.');
        }, 1000);
      });
    </script>

    <script>
      console.log('ğŸ”„ ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œë¨ - í˜ì´ì§€ê°€ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤.');
      
      const form = document.getElementById('email-form');
      const successMessage = document.getElementById('submission-success');
      const errorMessage = document.getElementById('submission-error');
      const iframe = document.getElementById('hidden-iframe');
      const submitButton = form.querySelector('button[type="submit"]');
      
      // ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ë„ ì¶”ê°€ (í¼ ì œì¶œ ì´ë²¤íŠ¸ì™€ ë³„ê°œë¡œ)
      submitButton.addEventListener('click', function() {
        console.log('ğŸ–±ï¸ í™•ì¸ ë²„íŠ¼ì´ í´ë¦­ë˜ì—ˆìŠµë‹ˆë‹¤.');
      });
      
      // í¼ ì œì¶œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
      form.addEventListener('submit', function(e) {
        console.log('ğŸ“ í¼ ì œì¶œ ì´ë²¤íŠ¸ ë°œìƒ');
        
        const email = document.getElementById('email').value.trim();
        
        if (!email) {
          e.preventDefault(); // ì´ë©”ì¼ì´ ì—†ìœ¼ë©´ ì œì¶œ ë°©ì§€
          alert('ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
          console.log('â›” ì œì¶œ ì‹¤íŒ¨: ì´ë©”ì¼ì´ ì…ë ¥ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
          return;
        }
        
        // íƒ€ì„ìŠ¤íƒ¬í”„ ì„¤ì •
        document.getElementById('timestamp').value = new Date().toISOString();
        
        console.log('ğŸ”„ í¼ ì œì¶œ ì‹œë„:', { 
          email, 
          timestamp: document.getElementById('timestamp').value 
        });
        console.log('ğŸ“¤ Google Apps Scriptë¡œ ë°ì´í„° ì „ì†¡ ì‹œì‘...');
        
        // ì œì¶œ ë²„íŠ¼ ë¹„í™œì„±í™”
        submitButton.disabled = true;
        submitButton.innerText = 'ì œì¶œ ì¤‘...';
        
        // ì„±ê³µ ë©”ì‹œì§€ë¥¼ ë””ë²„ê¹… ëª©ì ìœ¼ë¡œ ë°”ë¡œ í‘œì‹œ (í…ŒìŠ¤íŠ¸ìš©)
        setTimeout(() => {
          console.log('â±ï¸ í…ŒìŠ¤íŠ¸: 5ì´ˆ í›„ ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ (ì‹¤ì œ ì œì¶œê³¼ ë¬´ê´€)');
        }, 5000);
        
        // í¼ ì œì¶œì€ ê¸°ë³¸ ë™ì‘ìœ¼ë¡œ ì²˜ë¦¬ë¨
      });
      
      // iframe ë¡œë“œ ì´ë²¤íŠ¸
      iframe.addEventListener('load', function() {
        console.log('ğŸ”„ iframe ë¡œë“œë¨ - ì‘ë‹µ í™•ì¸ ì¤‘...');
        
        try {
          // iframe ë‚´ìš© í™•ì¸ ì‹œë„
          const iframeContent = iframe.contentWindow.document.body.innerHTML;
          console.log('ğŸ“© ì‘ë‹µ ë°ì´í„°:', iframeContent);
          
          // "success"ê°€ í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸ (Google Apps Script ì‘ë‹µì— ë”°ë¼ ë‹¤ë¥¼ ìˆ˜ ìˆìŒ)
          if (iframeContent.includes('success')) {
            console.log('âœ… ì œì¶œ ì„±ê³µ: ë°ì´í„°ê°€ Google ìŠ¤í”„ë ˆë“œì‹œíŠ¸ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
          } else {
            console.log('âš ï¸ ì‘ë‹µì€ ë°›ì•˜ìœ¼ë‚˜ ì„±ê³µ ì—¬ë¶€ê°€ ë¶ˆí™•ì‹¤í•©ë‹ˆë‹¤.');
          }
        } catch (error) {
          console.log('âš ï¸ iframe ë‚´ìš©ì„ í™•ì¸í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. (CORS ì •ì±…ìœ¼ë¡œ ì¸í•œ ì œí•œì¼ ìˆ˜ ìˆìŒ)');
          console.log('ğŸ“‹ ì˜¤ë¥˜ ì •ë³´:', error);
        }
        
        // iframeì´ ë¡œë“œë˜ë©´ ì„±ê³µ ì²˜ë¦¬
        if (submitButton.disabled) {
          submitButton.disabled = false;
          submitButton.innerText = 'í™•ì¸';
          
          successMessage.classList.remove('hidden');
          errorMessage.classList.add('hidden');
          
          form.reset(); // í¼ ì´ˆê¸°í™”
          console.log('ğŸ”„ í¼ ì´ˆê¸°í™” ì™„ë£Œ');
          
          // 5ì´ˆ í›„ ì„±ê³µ ë©”ì‹œì§€ ìˆ¨ê¹€
          setTimeout(() => {
            successMessage.classList.add('hidden');
            console.log('â„¹ï¸ ì„±ê³µ ë©”ì‹œì§€ê°€ ìˆ¨ê²¨ì¡ŒìŠµë‹ˆë‹¤.');
          }, 5000);
        }
      });

      // í†µì‹  ì˜¤ë¥˜ ê°ì§€ë¥¼ ìœ„í•œ ì¶”ê°€ ì½”ë“œ
      window.addEventListener('error', function(e) {
        if (e.target.tagName === 'IFRAME') {
          console.log('â›” iframe ë¡œë”© ì˜¤ë¥˜ ë°œìƒ:', e);
          
          // ì˜¤ë¥˜ ë©”ì‹œì§€ í‘œì‹œ
          errorMessage.classList.remove('hidden');
          successMessage.classList.add('hidden');
          
          // ì œì¶œ ë²„íŠ¼ í™œì„±í™”
          submitButton.disabled = false;
          submitButton.innerText = 'í™•ì¸';
        }
      }, true);
      
      // í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ì§ì ‘ í˜¸ì¶œ í•¨ìˆ˜ ì¶”ê°€
      window.testFormSubmission = function() {
        console.log('ğŸ§ª í…ŒìŠ¤íŠ¸ í•¨ìˆ˜ í˜¸ì¶œë¨');
        
        // ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ
        successMessage.classList.remove('hidden');
        errorMessage.classList.add('hidden');
        
        console.log('âœ… í…ŒìŠ¤íŠ¸: ì„±ê³µ ë©”ì‹œì§€ê°€ í‘œì‹œë˜ì—ˆìŠµë‹ˆë‹¤.');
        
        // 5ì´ˆ í›„ ì„±ê³µ ë©”ì‹œì§€ ìˆ¨ê¹€
        setTimeout(() => {
          successMessage.classList.add('hidden');
          console.log('â„¹ï¸ í…ŒìŠ¤íŠ¸: ì„±ê³µ ë©”ì‹œì§€ê°€ ìˆ¨ê²¨ì¡ŒìŠµë‹ˆë‹¤.');
        }, 5000);
      };
      
      console.log('âœ… ëª¨ë“  ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆê°€ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤. í¼ì„ ì œì¶œí•  ì¤€ë¹„ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤.');
    </script>
  </body>
</html>

<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI PPT 자동 생성</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      body {
        font-family: 'Pretendard', sans-serif;
      }
    </style>
  </head>
  <body class="bg-white text-gray-900 min-h-screen flex flex-col relative isolate overflow-hidden">
    <div class="absolute inset-0 -z-10 overflow-hidden">
      <div class="absolute left-1/2 top-0 transform -translate-x-1/2 blur-3xl">
        <div class="aspect-[1155/678] w-[80rem] bg-gradient-to-tr from-indigo-300 via-purple-300 to-pink-300 opacity-25" style="clip-path: polygon(74.1% 44.1%, 100% 61.6%, 97.5% 26.9%, 85.5% 0.1%, 80.7% 2%, 72.5% 32.5%, 60.2% 62.4%, 52.4% 68.1%, 47.5% 58.3%, 45.2% 34.5%, 27.5% 76.7%, 0.1% 64.9%, 17.9% 100%, 27.6% 76.8%, 76.1% 97.7%, 74.1% 44.1%)"></div>
      </div>
    </div>

    <main class="flex-grow flex items-center justify-center px-4">
      <section class="w-full max-w-3xl py-24 text-center">
        <h1 class="text-4xl sm:text-5xl font-bold tracking-tight text-gray-900">AI가 대신 만들어주는 PPT</h1>
        <p class="mt-6 text-lg leading-8 text-gray-600">주제만 입력하면 10분 만에 발표자료 완성! 디자인과 구성까지 자동화된 AI 발표 자료 생성기.</p>
        <p class="mt-4 text-sm text-indigo-600 font-medium">현재 대기자가 많습니다. 이메일을 남기시면 순서에 따라 안내드립니다.</p>

        <form id="email-form" class="mt-10 flex flex-col justify-center max-w-md mx-auto gap-4">
          <div class="flex flex-col sm:flex-row gap-4">
            <input id="name" name="name" type="text" placeholder="이름을 입력하세요" 
              class="min-w-0 flex-auto rounded-md bg-white px-4 py-2 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-indigo-500 sm:text-sm" />
            
            <input id="email" name="email" type="email" required placeholder="이메일을 입력하세요"
              class="min-w-0 flex-auto rounded-md bg-white px-4 py-2 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-indigo-500 sm:text-sm" />
          </div>
          
          <button type="submit"
            class="rounded-md bg-indigo-600 px-5 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600">
            확인
          </button>
        </form>
        <div id="submission-success" class="mt-4 text-green-600 hidden">
          감사합니다! 이메일이 성공적으로 저장되었습니다.
        </div>
        <div id="submission-error" class="mt-4 text-red-600 hidden">
          제출 중 오류가 발생했습니다. 다시 시도해 주세요.
        </div>
      </section>
    </main>

    <footer class="text-center text-sm text-gray-500 py-8">
      © 2025 benly. All rights reserved.
    </footer>

    <script>
      const form = document.getElementById('email-form');
      const successMessage = document.getElementById('submission-success');
      const errorMessage = document.getElementById('submission-error');
      
      // Google 스프레드시트 제출을 위한 URL - 아래 URL을 Apps Script URL로 변경해야 합니다
      const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyXXXXXXXXXXXXXX/exec';
      
      form.addEventListener('submit', function(e) {
        e.preventDefault();
        
        const name = document.getElementById('name').value.trim();
        const email = document.getElementById('email').value.trim();
        
        if (!email) {
          alert('이메일을 입력해주세요.');
          return;
        }
        
        // 제출 버튼 비활성화
        const submitButton = form.querySelector('button[type="submit"]');
        const originalButtonText = submitButton.innerText;
        submitButton.disabled = true;
        submitButton.innerText = '제출 중...';
        
        // 데이터 준비
        const formData = new FormData();
        formData.append('name', name);
        formData.append('email', email);
        formData.append('timestamp', new Date().toISOString());
        
        // Google Apps Script에 데이터 전송
        fetch(SCRIPT_URL, {
          method: 'POST',
          body: formData
        })
        .then(response => {
          if (response.ok) {
            // 성공 시
            form.reset();
            successMessage.classList.remove('hidden');
            errorMessage.classList.add('hidden');
            setTimeout(() => {
              successMessage.classList.add('hidden');
            }, 5000);
          } else {
            // 오류 발생 시
            throw new Error('네트워크 응답이 올바르지 않습니다.');
          }
        })
        .catch(error => {
          console.error('Error:', error);
          errorMessage.classList.remove('hidden');
          successMessage.classList.add('hidden');
        })
        .finally(() => {
          // 버튼 상태 복원
          submitButton.disabled = false;
          submitButton.innerText = originalButtonText;
        });
      });
    </script>
  </body>
</html>

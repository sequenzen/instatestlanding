<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ìƒí‘œê¶Œ ë“±ë¡ ì…€í”„ ì„œë¹„ìŠ¤</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      body {
        font-family: 'Pretendard', sans-serif;
      }
      .hidden-iframe {
        display: none;
        width: 0;
        height: 0;
        border: 0;
        border: none;
      }
    </style>
  </head>
  <body class="bg-white text-gray-900 min-h-screen flex flex-col relative isolate overflow-hidden">
    <div class="absolute inset-0 -z-10 overflow-hidden">
      <div class="absolute left-1/2 top-0 transform -translate-x-1/2 blur-3xl">
        <div class="aspect-[1155/678] w-[80rem] bg-gradient-to-tr from-slate-700 via-indigo-800 to-blue-900 opacity-20" style="clip-path: polygon(74.1% 44.1%, 100% 61.6%, 97.5% 26.9%, 85.5% 0.1%, 80.7% 2%, 72.5% 32.5%, 60.2% 62.4%, 52.4% 68.1%, 47.5% 58.3%, 45.2% 34.5%, 27.5% 76.7%, 0.1% 64.9%, 17.9% 100%, 27.6% 76.8%, 76.1% 97.7%, 74.1% 44.1%)"></div>
      </div>
    </div>

    <main class="flex-grow flex items-center justify-center px-4">
      <section class="w-full max-w-3xl py-24 text-center">
        <h1 class="text-4xl sm:text-5xl font-bold tracking-tight text-gray-900">ì…€í”„ ìƒí‘œ ë“±ë¡ ì„œë¹„ìŠ¤</h1>
        <p class="mt-6 text-lg leading-8 text-gray-600">ë³µì¡í•œ ì ˆì°¨ ì—†ì´, ëˆ„êµ¬ë‚˜ ì‰½ê²Œ ìƒí‘œê¶Œì„ ë“±ë¡í•  ìˆ˜ ìˆëŠ” ìë™í™” ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.</p>
        <p class="mt-4 text-sm text-indigo-700 font-medium">í˜„ì¬ ì´ìš©ìê°€ ë§ì•„ ëŒ€ê¸° ì¤‘ì…ë‹ˆë‹¤. ì´ë©”ì¼ì„ ë‚¨ê²¨ì£¼ì‹œë©´ ìˆœì°¨ì ìœ¼ë¡œ ì•ˆë‚´í•´ë“œë¦½ë‹ˆë‹¤.</p>

        <!-- Google Apps Scriptë¡œ ì „ì†¡í•  í¼ -->
        <form id="email-form" class="mt-10 flex flex-col justify-center max-w-md mx-auto gap-4" 
              target="hidden-iframe" 
              action="https://script.google.com/macros/s/AKfycbxC3xSiqeRcuN_efM9SIXyNz2F3PQGn1CCvVFLn_8Lh-KVRIJ8p9lZ4GVivMIHVTnEg/exec" 
              method="POST">
          <div class="flex flex-col sm:flex-row gap-4">
            <input id="email" name="email" type="email" required placeholder="ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”"
              class="min-w-0 flex-auto rounded-md bg-white px-4 py-2 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-indigo-600 sm:text-sm" />
          </div>
          
          <!-- ìˆ¨ê²¨ì§„ ì´ë¦„ í•„ë“œ ì¶”ê°€ (ì„œë²„ ì¸¡ ì²˜ë¦¬ ìœ ì§€) -->
          <input type="hidden" id="name" name="name" value="ìƒí‘œ ë“±ë¡ ë°©ë¬¸ì">
          
          <!-- ì‹œíŠ¸ êµ¬ë¶„ì„ ìœ„í•œ hidden í•„ë“œ ì¶”ê°€ -->
          <input type="hidden" id="sheet" name="sheet" value="Sheet3">
          
          <!-- ìˆ¨ê²¨ì§„ íƒ€ì„ìŠ¤íƒ¬í”„ í•„ë“œ ì¶”ê°€ -->
          <input type="hidden" id="timestamp" name="timestamp" value="">
          
          <button type="submit"
            class="flex-none rounded-md bg-indigo-600 px-5 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600">
            í™•ì¸
          </button>
        </form>
        
        <!-- ìˆ¨ê²¨ì§„ iframe -->
        <iframe name="hidden-iframe" id="hidden-iframe" class="hidden-iframe"></iframe>
        
        <div id="submission-success" class="mt-4 text-green-600 hidden">
          ê°ì‚¬í•©ë‹ˆë‹¤! ì´ë©”ì¼ì´ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.
        </div>
        <div id="submission-error" class="mt-4 text-red-600 hidden">
          ì œì¶œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.
        </div>
      </section>
    </main>

    <footer class="text-center text-sm text-gray-500 py-8 mt-auto">
      Â© 2025 benly. All rights reserved.
    </footer>

    <script>
      console.log('ğŸ”„ ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œë¨ - ìƒí‘œ ë“±ë¡ í˜ì´ì§€ê°€ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤.');
      
      const form = document.getElementById('email-form');
      const successMessage = document.getElementById('submission-success');
      const errorMessage = document.getElementById('submission-error');
      const iframe = document.getElementById('hidden-iframe');
      const submitButton = form.querySelector('button[type="submit"]');
      
      // í¼ ì œì¶œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
      form.addEventListener('submit', function(e) {
        console.log('ğŸ“ í¼ ì œì¶œ ì´ë²¤íŠ¸ ë°œìƒ');
        
        const email = document.getElementById('email').value.trim();
        
        if (!email) {
          e.preventDefault(); // ì´ë©”ì¼ì´ ì—†ìœ¼ë©´ ì œì¶œ ë°©ì§€
          alert('ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
          console.log('â›” ì œì¶œ ì‹¤íŒ¨: ì´ë©”ì¼ì´ ì…ë ¥ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
          return;
        }
        
        // íƒ€ì„ìŠ¤íƒ¬í”„ ì„¤ì •
        document.getElementById('timestamp').value = new Date().toISOString();
        
        console.log('ğŸ”„ í¼ ì œì¶œ ì‹œë„:', { 
          email, 
          sheet: 'Sheet3',
          timestamp: document.getElementById('timestamp').value 
        });
        console.log('ğŸ“¤ Google Apps Scriptë¡œ ë°ì´í„° ì „ì†¡ ì‹œì‘...');
        
        // ì œì¶œ ë²„íŠ¼ ë¹„í™œì„±í™”
        submitButton.disabled = true;
        submitButton.innerText = 'ì œì¶œ ì¤‘...';
        
        // í¼ ì œì¶œì€ ê¸°ë³¸ ë™ì‘ìœ¼ë¡œ ì²˜ë¦¬ë¨
      });
      
      // iframe ë¡œë“œ ì´ë²¤íŠ¸
      iframe.addEventListener('load', function() {
        console.log('ğŸ”„ iframe ë¡œë“œë¨ - ì‘ë‹µ í™•ì¸ ì¤‘...');
        
        try {
          // iframe ë‚´ìš© í™•ì¸ ì‹œë„
          const iframeContent = iframe.contentWindow.document.body.innerHTML;
          console.log('ğŸ“© ì‘ë‹µ ë°ì´í„°:', iframeContent);
          
          // "success"ê°€ í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸ (Google Apps Script ì‘ë‹µì— ë”°ë¼ ë‹¤ë¥¼ ìˆ˜ ìˆìŒ)
          if (iframeContent.includes('success')) {
            console.log('âœ… ì œì¶œ ì„±ê³µ: ë°ì´í„°ê°€ Google ìŠ¤í”„ë ˆë“œì‹œíŠ¸ì˜ Sheet3ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
          } else {
            console.log('âš ï¸ ì‘ë‹µì€ ë°›ì•˜ìœ¼ë‚˜ ì„±ê³µ ì—¬ë¶€ê°€ ë¶ˆí™•ì‹¤í•©ë‹ˆë‹¤.');
          }
        } catch (error) {
          console.log('âš ï¸ iframe ë‚´ìš©ì„ í™•ì¸í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. (CORS ì •ì±…ìœ¼ë¡œ ì¸í•œ ì œí•œì¼ ìˆ˜ ìˆìŒ)');
          console.log('ğŸ“‹ ì˜¤ë¥˜ ì •ë³´:', error);
        }
        
        // iframeì´ ë¡œë“œë˜ë©´ ì„±ê³µ ì²˜ë¦¬
        if (submitButton.disabled) {
          submitButton.disabled = false;
          submitButton.innerText = 'í™•ì¸';
          
          successMessage.classList.remove('hidden');
          errorMessage.classList.add('hidden');
          
          form.reset(); // í¼ ì´ˆê¸°í™”
          console.log('ğŸ”„ í¼ ì´ˆê¸°í™” ì™„ë£Œ');
          
          // 5ì´ˆ í›„ ì„±ê³µ ë©”ì‹œì§€ ìˆ¨ê¹€
          setTimeout(() => {
            successMessage.classList.add('hidden');
            console.log('â„¹ï¸ ì„±ê³µ ë©”ì‹œì§€ê°€ ìˆ¨ê²¨ì¡ŒìŠµë‹ˆë‹¤.');
          }, 5000);
        }
      });

      // í†µì‹  ì˜¤ë¥˜ ê°ì§€ë¥¼ ìœ„í•œ ì¶”ê°€ ì½”ë“œ
      window.addEventListener('error', function(e) {
        if (e.target.tagName === 'IFRAME') {
          console.log('â›” iframe ë¡œë”© ì˜¤ë¥˜ ë°œìƒ:', e);
          
          // ì˜¤ë¥˜ ë©”ì‹œì§€ í‘œì‹œ
          errorMessage.classList.remove('hidden');
          successMessage.classList.add('hidden');
          
          // ì œì¶œ ë²„íŠ¼ í™œì„±í™”
          submitButton.disabled = false;
          submitButton.innerText = 'í™•ì¸';
        }
      }, true);
      
      console.log('âœ… ëª¨ë“  ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆê°€ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤. í¼ì„ ì œì¶œí•  ì¤€ë¹„ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤.');
    </script>
  </body>
</html>
